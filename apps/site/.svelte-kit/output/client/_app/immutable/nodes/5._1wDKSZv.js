var lt=i=>{throw TypeError(i)};var G=(i,t,s)=>t.has(i)||lt("Cannot "+s);var e=(i,t,s)=>(G(i,t,"read from private field"),s?s.call(i):t.get(i)),d=(i,t,s)=>t.has(i)?lt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,s),h=(i,t,s,n)=>(G(i,t,"write to private field"),n?n.call(i,s):t.set(i,s),s),u=(i,t,s)=>(G(i,t,"access private method"),s);import"../chunks/Bzak7iHL.js";import"../chunks/69_IOA4Y.js";import{p as St,a as Ct}from"../chunks/CwJCq5ve.js";import{i as It}from"../chunks/Co2I-fr9.js";import{S as Qt,p as dt,r as y,s as X,a as A,n as yt,i as ft,b as pt,t as wt,c as H,f as Ut,d as Ft,e as bt,g as Rt,h as Tt,u as Dt}from"../chunks/CcJnCJ5x.js";import{d as J,g as Et,r as Pt}from"../chunks/ByswgImg.js";var b,r,k,f,U,P,S,C,z,x,L,F,T,I,M,a,j,Y,Z,$,q,tt,et,st,Ot,vt,xt=(vt=class extends Qt{constructor(t,s){super();d(this,a);d(this,b);d(this,r);d(this,k);d(this,f);d(this,U);d(this,P);d(this,S);d(this,C);d(this,z);d(this,x);d(this,L);d(this,F);d(this,T);d(this,I);d(this,M,new Set);this.options=s,h(this,b,t),h(this,C,null),h(this,S,dt()),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(e(this,r).addObserver(this),mt(e(this,r),this.options)?u(this,a,j).call(this):this.updateResult(),u(this,a,q).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return it(e(this,r),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return it(e(this,r),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,u(this,a,tt).call(this),u(this,a,et).call(this),e(this,r).removeObserver(this)}setOptions(t){const s=this.options,n=e(this,r);if(this.options=e(this,b).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof y(this.options.enabled,e(this,r))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");u(this,a,st).call(this),e(this,r).setOptions(this.options),s._defaulted&&!X(this.options,s)&&e(this,b).getQueryCache().notify({type:"observerOptionsUpdated",query:e(this,r),observer:this});const l=this.hasListeners();l&&gt(e(this,r),n,this.options,s)&&u(this,a,j).call(this),this.updateResult(),l&&(e(this,r)!==n||y(this.options.enabled,e(this,r))!==y(s.enabled,e(this,r))||A(this.options.staleTime,e(this,r))!==A(s.staleTime,e(this,r)))&&u(this,a,Y).call(this);const c=u(this,a,Z).call(this);l&&(e(this,r)!==n||y(this.options.enabled,e(this,r))!==y(s.enabled,e(this,r))||c!==e(this,I))&&u(this,a,$).call(this,c)}getOptimisticResult(t){const s=e(this,b).getQueryCache().build(e(this,b),t),n=this.createResult(s,t);return Mt(this,n)&&(h(this,f,n),h(this,P,this.options),h(this,U,e(this,r).state)),n}getCurrentResult(){return e(this,f)}trackResult(t,s){return new Proxy(t,{get:(n,l)=>(this.trackProp(l),s==null||s(l),l==="promise"&&!this.options.experimental_prefetchInRender&&e(this,S).status==="pending"&&e(this,S).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(n,l))})}trackProp(t){e(this,M).add(t)}getCurrentQuery(){return e(this,r)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=e(this,b).defaultQueryOptions(t),n=e(this,b).getQueryCache().build(e(this,b),s);return n.fetch().then(()=>this.createResult(n,s))}fetch(t){return u(this,a,j).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),e(this,f)))}createResult(t,s){var ut;const n=e(this,r),l=this.options,c=e(this,f),R=e(this,U),v=e(this,P),_=t!==n?t.state:e(this,k),{state:m}=t;let o={...m},Q=!1,p;if(s._optimisticResults){const g=this.hasListeners(),B=!g&&mt(t,s),E=g&&gt(t,n,s,l);(B||E)&&(o={...o,...Ft(m.data,t.options)}),s._optimisticResults==="isRestoring"&&(o.fetchStatus="idle")}let{error:nt,errorUpdatedAt:at,status:w}=o;p=o.data;let ot=!1;if(s.placeholderData!==void 0&&p===void 0&&w==="pending"){let g;c!=null&&c.isPlaceholderData&&s.placeholderData===(v==null?void 0:v.placeholderData)?(g=c.data,ot=!0):g=typeof s.placeholderData=="function"?s.placeholderData((ut=e(this,L))==null?void 0:ut.state.data,e(this,L)):s.placeholderData,g!==void 0&&(w="success",p=bt(c==null?void 0:c.data,g,s),Q=!0)}if(s.select&&p!==void 0&&!ot)if(c&&p===(R==null?void 0:R.data)&&s.select===e(this,z))p=e(this,x);else try{h(this,z,s.select),p=s.select(p),p=bt(c==null?void 0:c.data,p,s),h(this,x,p),h(this,C,null)}catch(g){h(this,C,g)}e(this,C)&&(nt=e(this,C),p=e(this,x),at=Date.now(),w="error");const K=o.fetchStatus==="fetching",V=w==="pending",N=w==="error",ht=V&&K,ct=p!==void 0,O={status:w,fetchStatus:o.fetchStatus,isPending:V,isSuccess:w==="success",isError:N,isInitialLoading:ht,isLoading:ht,data:p,dataUpdatedAt:o.dataUpdatedAt,error:nt,errorUpdatedAt:at,failureCount:o.fetchFailureCount,failureReason:o.fetchFailureReason,errorUpdateCount:o.errorUpdateCount,isFetched:o.dataUpdateCount>0||o.errorUpdateCount>0,isFetchedAfterMount:o.dataUpdateCount>_.dataUpdateCount||o.errorUpdateCount>_.errorUpdateCount,isFetching:K,isRefetching:K&&!V,isLoadingError:N&&!ct,isPaused:o.fetchStatus==="paused",isPlaceholderData:Q,isRefetchError:N&&ct,isStale:rt(t,s),refetch:this.refetch,promise:e(this,S),isEnabled:y(s.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const g=W=>{O.status==="error"?W.reject(O.error):O.data!==void 0&&W.resolve(O.data)},B=()=>{const W=h(this,S,O.promise=dt());g(W)},E=e(this,S);switch(E.status){case"pending":t.queryHash===n.queryHash&&g(E);break;case"fulfilled":(O.status==="error"||O.data!==E.value)&&B();break;case"rejected":(O.status!=="error"||O.error!==E.reason)&&B();break}}return O}updateResult(){const t=e(this,f),s=this.createResult(e(this,r),this.options);if(h(this,U,e(this,r).state),h(this,P,this.options),e(this,U).data!==void 0&&h(this,L,e(this,r)),X(s,t))return;h(this,f,s);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:l}=this.options,c=typeof l=="function"?l():l;if(c==="all"||!c&&!e(this,M).size)return!0;const R=new Set(c??e(this,M));return this.options.throwOnError&&R.add("error"),Object.keys(e(this,f)).some(v=>{const D=v;return e(this,f)[D]!==t[D]&&R.has(D)})};u(this,a,Ot).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&u(this,a,q).call(this)}},b=new WeakMap,r=new WeakMap,k=new WeakMap,f=new WeakMap,U=new WeakMap,P=new WeakMap,S=new WeakMap,C=new WeakMap,z=new WeakMap,x=new WeakMap,L=new WeakMap,F=new WeakMap,T=new WeakMap,I=new WeakMap,M=new WeakMap,a=new WeakSet,j=function(t){u(this,a,st).call(this);let s=e(this,r).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(yt)),s},Y=function(){u(this,a,tt).call(this);const t=A(this.options.staleTime,e(this,r));if(ft||e(this,f).isStale||!pt(t))return;const n=wt(e(this,f).dataUpdatedAt,t)+1;h(this,F,H.setTimeout(()=>{e(this,f).isStale||this.updateResult()},n))},Z=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(e(this,r)):this.options.refetchInterval)??!1},$=function(t){u(this,a,et).call(this),h(this,I,t),!(ft||y(this.options.enabled,e(this,r))===!1||!pt(e(this,I))||e(this,I)===0)&&h(this,T,H.setInterval(()=>{(this.options.refetchIntervalInBackground||Ut.isFocused())&&u(this,a,j).call(this)},e(this,I)))},q=function(){u(this,a,Y).call(this),u(this,a,$).call(this,u(this,a,Z).call(this))},tt=function(){e(this,F)&&(H.clearTimeout(e(this,F)),h(this,F,void 0))},et=function(){e(this,T)&&(H.clearInterval(e(this,T)),h(this,T,void 0))},st=function(){const t=e(this,b).getQueryCache().build(e(this,b),this.options);if(t===e(this,r))return;const s=e(this,r);h(this,r,t),h(this,k,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},Ot=function(t){Rt.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(e(this,f))}),e(this,b).getQueryCache().notify({query:e(this,r),type:"observerResultsUpdated"})})},vt);function Lt(i,t){return y(t.enabled,i)!==!1&&i.state.data===void 0&&!(i.state.status==="error"&&t.retryOnMount===!1)}function mt(i,t){return Lt(i,t)||i.state.data!==void 0&&it(i,t,t.refetchOnMount)}function it(i,t,s){if(y(t.enabled,i)!==!1&&A(t.staleTime,i)!=="static"){const n=typeof s=="function"?s(i):s;return n==="always"||n!==!1&&rt(i,t)}return!1}function gt(i,t,s,n){return(i!==t||y(n.enabled,i)===!1)&&(!s.suspense||i.state.status!=="error")&&rt(i,s)}function rt(i,t){return y(t.enabled,i)!==!1&&i.isStaleByTime(A(t.staleTime,i))}function Mt(i,t){return!X(i.getCurrentResult(),t)}function _t(){return Tt()}function jt(i){return"subscribe"in i&&typeof i.subscribe=="function"}function At(i,t,s){const n=Dt(s),l=_t(),c=jt(i)?i:Pt(i),R=J([c,l],([m,o])=>{const Q=n.defaultQueryOptions(m);return Q._optimisticResults=o?"isRestoring":"optimistic",Q}),v=new t(n,Et(R));R.subscribe(m=>{v.setOptions(m)});const D=J(l,(m,o)=>{const Q=m?yt:v.subscribe(Rt.batchCalls(o));return v.updateResult(),Q}),{subscribe:_}=J([D,R],([m,o])=>(m=v.getOptimisticResult(o),o.notifyOnChangeProps?m:v.trackResult(m)));return{subscribe:_}}function kt(i,t){return At(i,xt,t)}const zt=async()=>{try{const i=[];return Promise.resolve(i)}catch(i){return Promise.reject(i)}},Bt=async()=>{try{return(await zt()).filter(t=>t.species==="dog")}catch(i){return Promise.reject(i)}};function Yt(i,t){St(t,!1),kt({queryKey:["available-dogs"],queryFn:async()=>Bt()}),It(),Ct()}export{Yt as component};
