var Ot=i=>{throw TypeError(i)};var et=(i,s,t)=>s.has(i)||Ot("Cannot "+t);var e=(i,s,t)=>(et(i,s,"read from private field"),t?t.call(i):s.get(i)),d=(i,s,t)=>s.has(i)?Ot("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(i):s.set(i,t),l=(i,s,t,n)=>(et(i,s,"write to private field"),n?n.call(i,t):s.set(i,t),t),f=(i,s,t)=>(et(i,s,"access private method"),t);import{S as kt,p as St,r as S,s as rt,a as V,n as zt,i as Ct,b as It,t as Lt,c as J,f as Bt,d as Kt,e as Et,g as Vt,h as Wt,u as Ht}from"./CFhvAqoD.js";import{aj as W,aE as Tt,a5 as Gt,g as c,ai as _,aF as st,M as Nt,y as Ut,d as $t,an as Jt,u as Pt}from"./DWiYMfgV.js";var g,h,H,m,D,j,E,T,G,M,k,U,x,P,z,u,K,nt,at,ot,ht,ut,ct,lt,xt,Dt,Xt=(Dt=class extends kt{constructor(s,t){super();d(this,u);d(this,g);d(this,h);d(this,H);d(this,m);d(this,D);d(this,j);d(this,E);d(this,T);d(this,G);d(this,M);d(this,k);d(this,U);d(this,x);d(this,P);d(this,z,new Set);this.options=t,l(this,g,s),l(this,T,null),l(this,E,St()),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(e(this,h).addObserver(this),Ft(e(this,h),this.options)?f(this,u,K).call(this):this.updateResult(),f(this,u,ht).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return dt(e(this,h),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return dt(e(this,h),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,f(this,u,ut).call(this),f(this,u,ct).call(this),e(this,h).removeObserver(this)}setOptions(s){const t=this.options,n=e(this,h);if(this.options=e(this,g).defaultQueryOptions(s),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof S(this.options.enabled,e(this,h))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");f(this,u,lt).call(this),e(this,h).setOptions(this.options),t._defaulted&&!rt(this.options,t)&&e(this,g).getQueryCache().notify({type:"observerOptionsUpdated",query:e(this,h),observer:this});const o=this.hasListeners();o&&Qt(e(this,h),n,this.options,t)&&f(this,u,K).call(this),this.updateResult(),o&&(e(this,h)!==n||S(this.options.enabled,e(this,h))!==S(t.enabled,e(this,h))||V(this.options.staleTime,e(this,h))!==V(t.staleTime,e(this,h)))&&f(this,u,nt).call(this);const r=f(this,u,at).call(this);o&&(e(this,h)!==n||S(this.options.enabled,e(this,h))!==S(t.enabled,e(this,h))||r!==e(this,P))&&f(this,u,ot).call(this,r)}getOptimisticResult(s){const t=e(this,g).getQueryCache().build(e(this,g),s),n=this.createResult(t,s);return Zt(this,n)&&(l(this,m,n),l(this,j,this.options),l(this,D,e(this,h).state)),n}getCurrentResult(){return e(this,m)}trackResult(s,t){return new Proxy(s,{get:(n,o)=>(this.trackProp(o),t==null||t(o),o==="promise"&&!this.options.experimental_prefetchInRender&&e(this,E).status==="pending"&&e(this,E).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(n,o))})}trackProp(s){e(this,z).add(s)}getCurrentQuery(){return e(this,h)}refetch({...s}={}){return this.fetch({...s})}fetchOptimistic(s){const t=e(this,g).defaultQueryOptions(s),n=e(this,g).getQueryCache().build(e(this,g),t);return n.fetch().then(()=>this.createResult(n,t))}fetch(s){return f(this,u,K).call(this,{...s,cancelRefetch:s.cancelRefetch??!0}).then(()=>(this.updateResult(),e(this,m)))}createResult(s,t){var wt;const n=e(this,h),o=this.options,r=e(this,m),a=e(this,D),b=e(this,j),p=s!==n?s.state:e(this,H),{state:R}=s;let y={...R},bt=!1,v;if(t._optimisticResults){const w=this.hasListeners(),N=!w&&Ft(s,t),A=w&&Qt(s,n,t,o);(N||A)&&(y={...y,...Kt(R.data,s.options)}),t._optimisticResults==="isRestoring"&&(y.fetchStatus="idle")}let{error:yt,errorUpdatedAt:mt,status:Q}=y;v=y.data;let vt=!1;if(t.placeholderData!==void 0&&v===void 0&&Q==="pending"){let w;r!=null&&r.isPlaceholderData&&t.placeholderData===(b==null?void 0:b.placeholderData)?(w=r.data,vt=!0):w=typeof t.placeholderData=="function"?t.placeholderData((wt=e(this,k))==null?void 0:wt.state.data,e(this,k)):t.placeholderData,w!==void 0&&(Q="success",v=Et(r==null?void 0:r.data,w,t),bt=!0)}if(t.select&&v!==void 0&&!vt)if(r&&v===(a==null?void 0:a.data)&&t.select===e(this,G))v=e(this,M);else try{l(this,G,t.select),v=t.select(v),v=Et(r==null?void 0:r.data,v,t),l(this,M,v),l(this,T,null)}catch(w){l(this,T,w)}e(this,T)&&(yt=e(this,T),v=e(this,M),mt=Date.now(),Q="error");const Z=y.fetchStatus==="fetching",q=Q==="pending",tt=Q==="error",gt=q&&Z,Rt=v!==void 0,I={status:Q,fetchStatus:y.fetchStatus,isPending:q,isSuccess:Q==="success",isError:tt,isInitialLoading:gt,isLoading:gt,data:v,dataUpdatedAt:y.dataUpdatedAt,error:yt,errorUpdatedAt:mt,failureCount:y.fetchFailureCount,failureReason:y.fetchFailureReason,errorUpdateCount:y.errorUpdateCount,isFetched:y.dataUpdateCount>0||y.errorUpdateCount>0,isFetchedAfterMount:y.dataUpdateCount>p.dataUpdateCount||y.errorUpdateCount>p.errorUpdateCount,isFetching:Z,isRefetching:Z&&!q,isLoadingError:tt&&!Rt,isPaused:y.fetchStatus==="paused",isPlaceholderData:bt,isRefetchError:tt&&Rt,isStale:pt(s,t),refetch:this.refetch,promise:e(this,E),isEnabled:S(t.enabled,s)!==!1};if(this.options.experimental_prefetchInRender){const w=$=>{I.status==="error"?$.reject(I.error):I.data!==void 0&&$.resolve(I.data)},N=()=>{const $=l(this,E,I.promise=St());w($)},A=e(this,E);switch(A.status){case"pending":s.queryHash===n.queryHash&&w(A);break;case"fulfilled":(I.status==="error"||I.data!==A.value)&&N();break;case"rejected":(I.status!=="error"||I.error!==A.reason)&&N();break}}return I}updateResult(){const s=e(this,m),t=this.createResult(e(this,h),this.options);if(l(this,D,e(this,h).state),l(this,j,this.options),e(this,D).data!==void 0&&l(this,k,e(this,h)),rt(t,s))return;l(this,m,t);const n=()=>{if(!s)return!0;const{notifyOnChangeProps:o}=this.options,r=typeof o=="function"?o():o;if(r==="all"||!r&&!e(this,z).size)return!0;const a=new Set(r??e(this,z));return this.options.throwOnError&&a.add("error"),Object.keys(e(this,m)).some(b=>{const C=b;return e(this,m)[C]!==s[C]&&a.has(C)})};f(this,u,xt).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&f(this,u,ht).call(this)}},g=new WeakMap,h=new WeakMap,H=new WeakMap,m=new WeakMap,D=new WeakMap,j=new WeakMap,E=new WeakMap,T=new WeakMap,G=new WeakMap,M=new WeakMap,k=new WeakMap,U=new WeakMap,x=new WeakMap,P=new WeakMap,z=new WeakMap,u=new WeakSet,K=function(s){f(this,u,lt).call(this);let t=e(this,h).fetch(this.options,s);return s!=null&&s.throwOnError||(t=t.catch(zt)),t},nt=function(){f(this,u,ut).call(this);const s=V(this.options.staleTime,e(this,h));if(Ct||e(this,m).isStale||!It(s))return;const n=Lt(e(this,m).dataUpdatedAt,s)+1;l(this,U,J.setTimeout(()=>{e(this,m).isStale||this.updateResult()},n))},at=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(e(this,h)):this.options.refetchInterval)??!1},ot=function(s){f(this,u,ct).call(this),l(this,P,s),!(Ct||S(this.options.enabled,e(this,h))===!1||!It(e(this,P))||e(this,P)===0)&&l(this,x,J.setInterval(()=>{(this.options.refetchIntervalInBackground||Bt.isFocused())&&f(this,u,K).call(this)},e(this,P)))},ht=function(){f(this,u,nt).call(this),f(this,u,ot).call(this,f(this,u,at).call(this))},ut=function(){e(this,U)&&(J.clearTimeout(e(this,U)),l(this,U,void 0))},ct=function(){e(this,x)&&(J.clearInterval(e(this,x)),l(this,x,void 0))},lt=function(){const s=e(this,g).getQueryCache().build(e(this,g),this.options);if(s===e(this,h))return;const t=e(this,h);l(this,h,s),l(this,H,s.state),this.hasListeners()&&(t==null||t.removeObserver(this),s.addObserver(this))},xt=function(s){Vt.batch(()=>{s.listeners&&this.listeners.forEach(t=>{t(e(this,m))}),e(this,g).getQueryCache().notify({query:e(this,h),type:"observerResultsUpdated"})})},Dt);function Yt(i,s){return S(s.enabled,i)!==!1&&i.state.data===void 0&&!(i.state.status==="error"&&s.retryOnMount===!1)}function Ft(i,s){return Yt(i,s)||i.state.data!==void 0&&dt(i,s,s.refetchOnMount)}function dt(i,s,t){if(S(s.enabled,i)!==!1&&V(s.staleTime,i)!=="static"){const n=typeof t=="function"?t(i):t;return n==="always"||n!==!1&&pt(i,s)}return!1}function Qt(i,s,t,n){return(i!==s||S(n.enabled,i)===!1)&&(!t.suspense||i.state.status!=="error")&&pt(i,t)}function pt(i,s){return S(s.enabled,i)!==!1&&i.isStaleByTime(V(s.staleTime,i))}function Zt(i,s){return!rt(i.getCurrentResult(),s)}function qt(){return Wt()}var te=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],ee=["difference","intersection","symmetricDifference","union"],_t=!1,L,O,F,X,B,At,jt;const Y=class Y extends Set{constructor(t){super();d(this,B);d(this,L,new Map);d(this,O,W(0));d(this,F,W(0));d(this,X,Tt||-1);if(t){for(var n of t)super.add(n);e(this,F).v=super.size}_t||f(this,B,jt).call(this)}has(t){var n=super.has(t),o=e(this,L),r=o.get(t);if(r===void 0){if(!n)return c(e(this,O)),!1;r=f(this,B,At).call(this,!0),o.set(t,r)}return c(r),n}add(t){return super.has(t)||(super.add(t),_(e(this,F),super.size),st(e(this,O))),this}delete(t){var n=super.delete(t),o=e(this,L),r=o.get(t);return r!==void 0&&(o.delete(t),_(r,!1)),n&&(_(e(this,F),super.size),st(e(this,O))),n}clear(){if(super.size!==0){super.clear();var t=e(this,L);for(var n of t.values())_(n,!1);t.clear(),_(e(this,F),0),st(e(this,O))}}keys(){return this.values()}values(){return c(e(this,O)),super.values()}entries(){return c(e(this,O)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return c(e(this,F))}};L=new WeakMap,O=new WeakMap,F=new WeakMap,X=new WeakMap,B=new WeakSet,At=function(t){return Tt===e(this,X)?W(t):Gt(t)},jt=function(){_t=!0;var t=Y.prototype,n=Set.prototype;for(const o of te)t[o]=function(...r){return c(e(this,O)),n[o].apply(this,r)};for(const o of ee)t[o]=function(...r){c(e(this,O));var a=n[o].apply(this,r);return new Y(a)}};let ft=Y;function se(i){const s=Array.isArray(i)?[]:{},t=new ft,n=new Proxy(s,{set(r,a,b,C){if(t.delete(a),a in r)return Reflect.set(r,a,b,C);let p=W(b);return Object.defineProperty(r,a,{configurable:!0,enumerable:!0,get:()=>c(p)&&re(c(p))?c(p)():c(p),set:R=>{_(p,R)}}),!0},has:(r,a)=>t.has(a)?!1:a in r,ownKeys(r){return Reflect.ownKeys(r).filter(a=>!t.has(a))},getOwnPropertyDescriptor(r,a){if(!t.has(a))return Reflect.getOwnPropertyDescriptor(r,a)},deleteProperty(r,a){return a in r?(r[a]=void 0,t.add(a),Array.isArray(r)&&r.length--,!0):!1}});function o(r){const a=Object.keys(n),b=Object.keys(r),C=a.filter(p=>!b.includes(p));for(const p of C)delete n[p];for(const p of b)n[p]=ie(()=>r[p])}return o(i),[n,o]}const Mt=Symbol("LazyValue");function ie(i){return i[Mt]=!0,i}function re(i){return!!i[Mt]}function ne(i,s){switch(i){case"post":Ut(s);break;case"pre":Nt(s);break}}const it=(i,s,t)=>{let n=!1,o=Array.isArray(i)?[]:void 0;ne(s,()=>{const r=Array.isArray(i)?i.map(b=>b()):i();if(!n){n=!0,o=r;return}const a=$t(()=>t(r,o));return o=r,a})};function ae(i,s,t){const n=Pt(()=>Ht(t==null?void 0:t())),o=qt(),r=Pt(()=>{const R=c(n).defaultQueryOptions(i());return R._optimisticResults=o.current?"isRestoring":"optimistic",R});let a=W(Jt(new s(c(n),c(r))));it(()=>c(n),"pre",()=>{_(a,new s(c(n),c(r)),!0)});function b(){const R=c(a).getOptimisticResult(c(r));return c(r).notifyOnChangeProps?R:c(a).trackResult(R)}const[C,p]=se(b());return Ut(()=>{const R=o.current?()=>{}:c(a).subscribe(()=>p(b()));return c(a).updateResult(),R}),it(()=>c(r),"pre",()=>{c(a).setOptions(c(r))}),it(()=>[c(r),c(a)],"pre",()=>{p(b())}),C}function le(i,s){return ae(i,Xt,s)}export{le as c};
